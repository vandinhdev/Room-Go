<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROOM GO - Cho Thu√™ Ph√≤ng Tr·ªç</title>
    <link rel="stylesheet" href="access/css/styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo">ROOM GO</div>
            <div class="location-selector">
                <span class="location-icon">üìç</span>
                <select id="provinceSelect" style="border:none;background:transparent;font-size:16px;color:#ff6b35;outline:none;">
                    <option value="">ƒêang t·∫£i t·ªânh th√†nh...</option>
                </select>
                <span>‚ñº</span>
            </div>
        </div>
        
        <div class="search-container">
            <input type="text" class="search-box" placeholder="T√¨m b·∫•t ƒë·ªông s·∫£n...">
        </div>
        
        <div class="header-right">
            <a href="chat.html" class="header-btn" style="color:#ff6b35;background:transparent;">üí¨ Chat</a>
            <a href="#" class="header-btn" style="color:#ff6b35;background:transparent;">‚ù§Ô∏è Y√™u th√≠ch</a>
            <a href="roomForm.html" class="header-btn post-btn">üìù ƒêƒÉng tin</a>
            <div id="authButtons">
                <!-- Will be populated by JS -->
            </div>
            <div class="user-menu d-none">
                <div class="user-menu-trigger">
                    <div class="user-avatar"></div>
                    <span class="user-name"></span>
                    <span class="dropdown-arrow">‚ñº</span>
                </div>
                <div class="dropdown-menu">
                    <div class="dropdown-header">
                        <div class="user-info">
                            <div class="user-avatar-large"></div>
                            <div class="user-details">
                                <div class="user-name-large"></div>
                                <div class="user-email"></div>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown-divider"></div>
                    <a href="#" class="dropdown-item">
                        <span class="item-icon">üë§</span>
                        Th√¥ng tin c√° nh√¢n
                    </a>
                    <a href="#" class="dropdown-item">
                        <span class="item-icon">üè†</span>
                        Ph√≤ng c·ªßa t√¥i
                    </a>
                    <a href="#" class="dropdown-item">
                        <span class="item-icon">‚ù§Ô∏è</span>
                        Ph√≤ng y√™u th√≠ch
                    </a>
                    <div class="dropdown-divider"></div>
                    <a href="#" class="dropdown-item text-danger" id="logoutBtn">
                        <span class="item-icon">üö™</span>
                        ƒêƒÉng xu·∫•t
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
    

        <!-- Filters -->
        <div class="filters">
            <div class="filter-btn">üîç L·ªçc</div>
            <select id="priceFilter" class="filter-btn" style="min-width:120px;">
                <option value="">Gi√° thu√™</option>
                <option value="1">D∆∞·ªõi 1 tri·ªáu</option>
                <option value="2">1-2 tri·ªáu</option>
                <option value="3">2-3 tri·ªáu</option>
                <option value="4">Tr√™n 3 tri·ªáu</option>
            </select>
            <select id="areaFilter" class="filter-btn" style="min-width:120px;">
                <option value="">Di·ªán t√≠ch</option>
                <option value="1">D∆∞·ªõi 15m¬≤</option>
                <option value="2">15-25m¬≤</option>
                <option value="3">25-35m¬≤</option>
                <option value="4">Tr√™n 35m¬≤</option>
            </select>
            <select id="districtSelect" class="filter-btn" style="min-width:120px;">
                <option value="">Qu·∫≠n/Huy·ªán</option>
            </select>
            <select id="wardSelect" class="filter-btn" style="min-width:120px;">
                <option value="">Ph∆∞·ªùng/X√£</option>
            </select>
            <div class="clear-filters">Xo√° l·ªçc</div>
        </div>

        <!-- Category Tags -->
        

        <!-- Content Tabs -->
        <div class="content-tabs">
            <div class="tab active">T·∫•t c·∫£</div>
            <div class="tab">C√° nh√¢n</div>
        </div>

        <!-- Sort & View Controls -->
        <div class="sort-view-controls">
            <div class="sort-control">
                <span>Tin m·ªõi nh·∫•t</span>
                <span>‚¨áÔ∏è</span>
            </div>
            <div class="view-toggle">
                <div class="view-btn">üìã</div>
                <div class="view-btn active">‚öè</div>
            </div>
            <a href="roomForm.html" class="btn-add-room">+ Th√™m ph√≤ng</a>
        </div>

        <!-- Listings Grid -->
        <div class="listings-grid" id="listingsGrid">
            <!-- Cards s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
        </div>
    </div>

    <script type="module" src="./js/main.js"></script>
    <script>
        // L·∫•y danh s√°ch t·ªânh th√†nh t·ª´ API v√† render v√†o dropdown
        document.addEventListener('DOMContentLoaded', function() {
            const provinceSelect = document.getElementById('provinceSelect');
            fetch('https://provinces.open-api.vn/api/p/')
                .then(res => res.json())
                .then(data => {
                    provinceSelect.innerHTML = '<option value="">T·∫•t c·∫£ t·ªânh th√†nh</option>' +
                        data.map(p => `<option value="${p.name}">${p.name}</option>`).join('');
                })
                .catch(() => {
                    provinceSelect.innerHTML = '<option value="">Kh√¥ng t·∫£i ƒë∆∞·ª£c d·ªØ li·ªáu</option>';
                });
        });
        // X·ª≠ l√Ω l·ªçc t·ªânh th√†nh, gi√°, di·ªán t√≠ch
        document.addEventListener('DOMContentLoaded', function() {
            const provinceSelect = document.getElementById('provinceSelect');
            const priceFilter = document.getElementById('priceFilter');
            const areaFilter = document.getElementById('areaFilter');
            const clearBtn = document.querySelector('.clear-filters');
            // L∆∞u l·∫°i h√†m renderRooms t·ª´ main.js
            let roomsData = window.roomsData || [];
            if (!roomsData.length && window.rooms) roomsData = window.rooms;
            function getFilteredRooms() {
                let filtered = roomsData;
                // L·ªçc t·ªânh th√†nh
                const province = provinceSelect.value;
                if (province) {
                    filtered = filtered.filter(r => r.address && r.address.includes(province));
                }
                // L·ªçc gi√°
                switch (priceFilter.value) {
                    case '1': filtered = filtered.filter(r => r.price < 1000000); break;
                    case '2': filtered = filtered.filter(r => r.price >= 1000000 && r.price <= 2000000); break;
                    case '3': filtered = filtered.filter(r => r.price > 2000000 && r.price <= 3000000); break;
                    case '4': filtered = filtered.filter(r => r.price > 3000000); break;
                }
                // L·ªçc di·ªán t√≠ch
                switch (areaFilter.value) {
                    case '1': filtered = filtered.filter(r => r.area < 15); break;
                    case '2': filtered = filtered.filter(r => r.area >= 15 && r.area <= 25); break;
                    case '3': filtered = filtered.filter(r => r.area > 25 && r.area <= 35); break;
                    case '4': filtered = filtered.filter(r => r.area > 35); break;
                }
                return filtered;
            }
            function updateRooms() {
                if (window.renderRooms) {
                    window.renderRooms(getFilteredRooms());
                }
            }
            provinceSelect.addEventListener('change', updateRooms);
            priceFilter.addEventListener('change', updateRooms);
            areaFilter.addEventListener('change', updateRooms);
            clearBtn.addEventListener('click', function() {
                provinceSelect.value = '';
                priceFilter.value = '';
                areaFilter.value = '';
                updateRooms();
            });
        });
    </script>

</body>
</html>